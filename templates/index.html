{% extends 'base.html' %}
<head>
    <link rel="stylesheet" href="app.css">
</head>
{% block body %}

<header id="header">
    <a href="/create" class="create-button">
        <img src="static/images/icons8-add-96.png">
    </a>
</header>

<div class="container">

    {% for post in posts %}

    <div class="d-inline-flex">
        <!-- タスクカードの情報 -->
        <div class="card text-white">
            <img class="card-img" id="imageArea{{ loop.index0 }}">
            <div class="card-img-overlay">
                <h2 class="card-title">{{ post.title }}</h2>
                <div class="flex card-due">
                    {% if post.due.date() < today %}
                    <i class="bi bi-exclamation-diamond"></i>
                    {% endif %}
                    <p>{{ post.due.date() }}</p>
                </div>
                <a href="/detail/{{ post.id }}" class="card-text text-white" role="button">Detail</a>
                <a href="/update/{{ post.id }}" class="card-text text-white" role="button">Update</a>
                <a href="/delete/{{ post.id }}" class="card-text text-white" role="button">Delete</a>
            </div>
        </div>
    </div>

    {% endfor %}

    <!-- ランダムに画像をあてる -->
    <script>
        function generateImageFilename(index) {
            return `static/randam-images/${index}.jpg`;
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        const totalImages = 39;
        const imageFilenames = Array.from({length: totalImages}, (_, i) => generateImageFilename(i + 1));
        const shuffledImages = shuffleArray([...imageFilenames]);

        for (let i = 0; i < "{{ posts|length }}"; i++) {
            const imageArea = document.getElementById('imageArea' + i);
            const imageNo = i % shuffledImages.length;
            imageArea.src = shuffledImages[imageNo];
        }
    </script>

</div>

{% endblock %}
